= heroku-java-buildpack-example image:https://travis-ci.org/daggerok/heroku-java-buildpack-example.svg?branch=master["Build Status", link="https://travis-ci.org/daggerok/heroku-java-buildpack-example"] image:https://gitlab.com/daggerok/heroku-java-buildpack-example/badges/master/build.svg["Build Status", link="https://gitlab.com/daggerok/heroku-java-buildpack-example/-/jobs"]

//tag::content[]
== development

.run locally
[source,bash]
----
./gradlew
java -jar build/libs/*.jar --spring.profiles.active=dev
SPRING_PROFILES_ACTIVE=dev bash build/libs/*.jar

./mvnw
java -Dspring.profiles.active=dev -jar target/*.jar
bash target/*.jar

./mvnw; ./mvnw com.dkanejs.maven.plugins:docker-compose-maven-plugin:1.0.1:up
./mvnw com.dkanejs.maven.plugins:docker-compose-maven-plugin:1.0.1:down
----

== production
.prepare heroku.yml
[source,yml]
----
# default java build pack will use maven wrapper command: `./mvnw clean innstall`
build:
  languages:
    - java
run:
  web: java -Dspring.profiles.active=dev -jar target/*.jar
----

.install heroku cli
[source,bash]
----
brew install heroku
----

.register in heroku.com and login
[source,bash]
----
heroku login
----

.create heroku app (in my case it's `daggerok-java-buildpack`)
[source,bash]
----
heroku create daggerok-java-buildpack
----

.deploy dev version first (using H2 inmemory database)
[source,bash]
----
git remote -v | grep heroku
git add .
git commit -am "First blood: prepare heroku development deployment."
git push heroku master
open https://daggerok-java-buildpack.herokuapp.com
heroku logs -t
----

.fix application base URL, by setting APP_BASE_URL env variable or by
setting app.base.url application config property pointing to proper URL
[source,bash]
----
heroku config:set APP_BASE_URL=https://daggerok-java-buildpack.herokuapp.com

# output:
# Setting APP_BASE_URL and restarting â¬¢ daggerok-java-buildpack... done, v5
# APP_BASE_URL: https://daggerok-java-buildpack.herokuapp.com
----

generated by link:https://github.com/daggerok/generator-jvm/[generator-jvm] yeoman generator (java-spring-boot)
//end::content[]
